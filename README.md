# 设置默认程序工具

这是一个Windows工具，用于设置文件扩展名的默认打开程序。大家可能经常会遇到用windows指定默认的应用程序打开某种文件扩展名（比如.docx用word，而不是wps），但是经常的情况是改了以后当时有用，重启后就没有效果了。于是我开发了这样的工具fix_default_app.exe来快速的让大家选择某个文件扩展名需要打开的默认应用程序，并且电脑重启后仍有效。

## 功能

- **批量设置默认程序**  
  支持一次输入多个扩展名（如 `.doc/.docx/.pptx`），一键将它们全部关联到同一个应用程序，极大提升效率。

- **规则管理与优先级排序**  
  内置图形化拖拽式规则编辑器，可添加、编辑、删除、排序所有文件关联规则，灵活管理不同扩展名的默认打开方式。

- **导入导出规则**  
  支持将所有自定义规则导出为 JSON 文件，方便备份、迁移或分享；也可一键导入规则文件，快速恢复设置。

- **默认程序设定统计与搜索**  
  内置统计窗口，自动扫描系统所有扩展名及其当前默认程序，并以美观表格展示，支持模糊搜索扩展名或程序路径，快速定位和检查关联情况。

- **全局快捷键唤起**  
  支持按下 `Ctrl+P` 快捷键，随时唤起主界面，方便快速操作。


- **兼容性与易用性**  
  结合 Windows 命令行和注册表双重设置，兼容 Windows 10/11，界面简洁直观，适合所有用户。

## 使用方法
1. 运行`fix_default_app.py`
2. 输入文件扩展名(如 `.txt` 或 `.doc/.docx`)
3. 选择应用程序路径（指定的默认应用程序路径可以是应用程序的真实路径或者快捷方式，路径的结尾是：.exe）
4. 点击"保存设置"按钮
5. 可使用“规则编辑器”管理所有关联规则，或导入/导出规则文件
6. 点击“默认程序设定统计”可查看和搜索系统所有扩展名的默认程序

## 依赖
- Python 3.8+
- tkinter
- pyinstaller(用于打包)
- keyboard

注意：  
由于Windows 的安全策略限制，所以.pdf 需在系统设置中手动指定默认程序。无法完全自动化