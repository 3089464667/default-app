【文件默认大师 用户手册】

一、软件简介
文件默认大师是一款专为Windows用户设计的文件扩展名默认程序设置与管理工具。它通过图形化界面，结合注册表和命令行操作，支持批量设置、规则管理、导入导出、统计、快捷键唤起、规则社区、文件夹图标更换、目录加密等功能，极大提升了文件关联管理的效率和体验。

二、安装与启动
1. 系统要求：Windows 10/11，Python 3.8+（如使用源码），或直接运行打包好的fix_default_app.exe。
2. 依赖安装（源码用户）：
   - 安装Python 3.8+。
   - 安装依赖库：`pip install ttkbootstrap requests keyboard pillow`
3. 启动方式：
   - 双击fix_default_app.exe（推荐）。
   - 或命令行输入：`python fix_default_app.py`
   - 支持全局快捷键Ctrl+P唤起主界面（需后台运行）。

三、主界面介绍
1. 顶部标题栏：显示软件名称与简要说明。
2. 文件扩展名输入区：输入需设置默认程序的扩展名（如`.txt`，支持多个扩展名用`/`分隔）。
3. 应用程序路径选择区：选择目标程序（如`notepad.exe`），可手动输入或点击“浏览...”按钮选择。
4. 操作按钮区：
   - 保存设置：批量设置扩展名的默认程序。
   - 规则编辑器：管理所有关联规则。
   - 导入规则/导出规则：支持JSON格式规则文件的导入导出。
   - 默认程序设定统计：查看系统所有扩展名及其默认程序，支持搜索。
   - 更换文件夹图标：自定义文件夹图标。
   - 规则空间：访问规则社区，上传/下载/评分/举报规则。
   - 设定目录密码/取消目录密码：对文件夹加密/解密。
5. 底部提示区：显示重要提示信息。

四、功能操作说明
1. 设置默认程序
   - 在“文件扩展名”输入框输入扩展名（如`.txt`或`.doc/.docx`）。
   - 在“应用程序路径”选择目标程序（如`notepad.exe`）。
   - 点击“保存设置”，程序会自动设置默认程序，支持批量操作。

2. 规则管理
   - 点击“规则编辑器”打开规则管理窗口。
   - 可添加、编辑、删除规则，支持拖拽排序调整优先级。
   - 规则以扩展名、程序路径、优先级为核心字段。

3. 规则导入导出
   - 导出：点击“导出规则”，选择保存路径，生成JSON规则文件。
   - 导入：点击“导入规则”，选择JSON文件，自动应用规则。

4. 默认程序统计
   - 点击“默认程序设定统计”。
   - 查看所有扩展名及其默认程序，支持输入关键词搜索。
   - 可用于检查系统中所有文件类型的关联情况。

5. 规则社区
   - 点击“规则空间”进入社区功能。
   - 首次需注册/登录账号。
   - 支持上传本地规则、下载他人规则、评分、举报、标签筛选、关键词搜索等。
   - 下载规则后自动应用，上传需填写规则名称、简介、标签。

6. 文件夹图标更换
   - 点击“更换文件夹图标”。
   - 选择目标文件夹和图片（支持png/jpg/jpeg/bmp/gif/ico）。
   - 程序自动转换为ico并设置为文件夹图标。

7. 目录加密/解密
   - 设定目录密码：选择目标文件夹，输入密码，所有内容将被隐藏并加密。
   - 取消目录密码：选择加密目录，输入密码，恢复所有内容可见。

8. 快捷键唤起
   - 程序后台运行时，按Ctrl+P可随时唤起主界面。

五、常见问题与注意事项
1. 某些扩展名（如.pdf）需在系统设置中手动指定默认程序，无法完全自动化。
2. 建议以管理员权限运行，以确保注册表操作成功。
3. 规则社区功能需联网，上传下载规则需注册登录。
4. 批量设置时请确保输入的扩展名和程序路径正确，避免误操作。
5. 如遇WPS等软件反复接管默认程序，请关闭相关设置或卸载相关组件。

六、数据备份与迁移
- 可通过“导出规则”备份所有自定义规则，迁移到新电脑时通过“导入规则”恢复。
- 社区规则可随时下载应用，便于团队共享。

七、更新与维护
- 软件持续维护，建议关注官方发布渠道获取最新版本。
- 如遇BUG或有建议，可通过社区反馈或联系开发者。

八、联系方式与支持
- 官方社区：规则空间内置于软件。
- 邮箱/QQ群/官网等联系方式请见软件关于页面或官方发布页。

九、免责声明
- 本软件为免费工具，用户自行承担使用风险。
- 请勿用于非法用途，因使用本软件造成的任何后果开发者不承担责任。
